{"version":3,"file":"static/js/872.c1e1e8ff.chunk.js","mappings":"8LA4CA,UApCyB,SAACA,GACtB,IAAOC,GAAMC,EAAAA,EAAAA,MAAND,GACPE,GAAmDC,EAAAA,EAAAA,UAC/C,CAAC,QAAS,CAACH,GAAIA,IAAMI,EAAAA,IADlBC,EAAIH,EAAJG,KAAMC,EAAOJ,EAAPI,QAASC,EAAKL,EAALK,MAAOC,EAASN,EAATM,UAAWC,EAAOP,EAAPO,QAQxC,IALAC,EAAAA,EAAAA,YAAU,WACDL,GAAQA,EAAKM,KAAK,IAAKN,EAAKM,KAAK,GAAGC,OACrCN,GAER,GAAG,CAACD,EAAMC,IACNE,EACA,OAAOK,EAAAA,EAAAA,KAACC,EAAAA,EAAO,IAGnB,GAAIL,EACA,OAAOI,EAAAA,EAAAA,KAAA,MAAAE,SAAKR,EAAMS,UAEtB,IAAKX,IAASA,EAAKM,KAAK,GAAGC,MACvB,OAAOC,EAAAA,EAAAA,KAACC,EAAAA,EAAO,IAGnB,IAAMG,EAASZ,EAAKM,KAEdO,EAAYD,EAAOE,QAAO,SAAAC,GAAC,OAAIA,EAAEC,QAAQ,IAG/C,OAFAC,aAAaC,QAAQ,YAAaC,KAAKC,UAAUP,KAG7CL,EAAAA,EAAAA,KAACa,EAAAA,EAAY,CACTd,MAAM,gBACNK,OAAQA,EACRU,OAAQ,SAACC,GACL,OAAOf,EAAAA,EAAAA,KAACgB,EAAAA,EAAkB,CAACD,MAAOA,GACtC,GAGZ,C","sources":["pages/movieCreditsPage.js"],"sourcesContent":["import React, {useEffect} from \"react\";\r\nimport {getMovieCredits} from \"../api/tmdb-api\";\r\nimport PageTemplate from '../components/templateMovieListPage';\r\nimport {useQuery} from 'react-query';\r\nimport Spinner from '../components/spinner';\r\nimport AddToFavoritesIcon from '../components/cardIcons/addToFavorites'\r\nimport {useParams} from \"react-router-dom\";\r\n\r\nconst MovieCreditsPage = (props) => {\r\n    const {id} = useParams();\r\n    const {data, refetch, error, isLoading, isError} = useQuery(\r\n        [\"movie\", {id: id}], getMovieCredits);\r\n\r\n    useEffect(() => {\r\n        if (!data ||!data.cast[0]||!data.cast[0].title) {\r\n            refetch();\r\n        }\r\n    }, [data, refetch]); // 依赖于 data 和 refetch\r\n    if (isLoading) {\r\n        return <Spinner/>\r\n    }\r\n\r\n    if (isError) {\r\n        return <h1>{error.message}</h1>\r\n    }\r\n    if (!data || !data.cast[0].title) {\r\n        return <Spinner/>; // 或者返回某种“无数据”或“加载中”的提示\r\n    }\r\n\r\n    const movies = data.cast;\r\n    // Redundant, but necessary to avoid app crashing.\r\n    const favorites = movies.filter(m => m.favorite)\r\n    localStorage.setItem('favorites', JSON.stringify(favorites))\r\n\r\n    return (\r\n        <PageTemplate\r\n            title=\"Movie Credits\"\r\n            movies={movies}\r\n            action={(movie) => {\r\n                return <AddToFavoritesIcon movie={movie}/>\r\n            }}\r\n        />\r\n    );\r\n};\r\nexport default MovieCreditsPage;"],"names":["props","id","useParams","_useQuery","useQuery","getMovieCredits","data","refetch","error","isLoading","isError","useEffect","cast","title","_jsx","Spinner","children","message","movies","favorites","filter","m","favorite","localStorage","setItem","JSON","stringify","PageTemplate","action","movie","AddToFavoritesIcon"],"sourceRoot":""}